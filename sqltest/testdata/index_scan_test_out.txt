-- Tests for index scan with different types and composite index;

use test;
0 rows returned

-- TINYINT;

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 tinyint,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_1;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
5 rows returned
select * from test_source_1 where col1 = -128;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 = -25;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 2                    | -25  |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 = 0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 3                    | 0    |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 = 33;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 4                    | 33   |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 = 127;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 5                    | 127  |
+-----------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = 99;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
0 rows returned

select * from test_source_1 where col1 > -128 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
4 rows returned
select * from test_source_1 where col1 > -25 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
3 rows returned
select * from test_source_1 where col1 > 33 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 5                    | 127  |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 > 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
0 rows returned

select * from test_source_1 where col1 >= -128 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
5 rows returned
select * from test_source_1 where col1 >= -25 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
4 rows returned
select * from test_source_1 where col1 >= 33 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
2 rows returned
select * from test_source_1 where col1 >= 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 5                    | 127  |
+-----------------------------+
1 rows returned

select * from test_source_1 where col1 < -128 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
0 rows returned
select * from test_source_1 where col1 < -25 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 < 33 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
| 3                    | 0    |
+-----------------------------+
3 rows returned
select * from test_source_1 where col1 < 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
+-----------------------------+
4 rows returned

select * from test_source_1 where col1 <= -128 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
+-----------------------------+
1 rows returned
select * from test_source_1 where col1 <= -25 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
+-----------------------------+
2 rows returned
select * from test_source_1 where col1 <= 33 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
+-----------------------------+
4 rows returned
select * from test_source_1 where col1 <= 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 1                    | -128 |
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
5 rows returned

select * from test_source_1 where col1 > -25 and col1 < 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 3                    | 0    |
| 4                    | 33   |
+-----------------------------+
2 rows returned
select * from test_source_1 where col1 > -25 and col1 <= 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
3 rows returned
select * from test_source_1 where col1 >= -25 and col1 < 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
+-----------------------------+
3 rows returned
select * from test_source_1 where col1 >= -25 and col1 <= 127 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
| 2                    | -25  |
| 3                    | 0    |
| 4                    | 33   |
| 5                    | 127  |
+-----------------------------+
4 rows returned

select * from test_source_1 where col1 > 33 and col1 < -25 order by col0;
+-----------------------------+
| col0                 | col1 |
+-----------------------------+
0 rows returned


drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- INT;

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 int,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_2;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
5 rows returned
select * from test_source_1 where col1 = -2147483648;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 = -25;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 2                    | -25         |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 3                    | 0           |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 33;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 4                    | 33          |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 2147483647;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 5                    | 2147483647  |
+------------------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = 99;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
0 rows returned

select * from test_source_1 where col1 > -2147483648 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
4 rows returned
select * from test_source_1 where col1 > -25 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
3 rows returned
select * from test_source_1 where col1 > 33 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 5                    | 2147483647  |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 > 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
0 rows returned

select * from test_source_1 where col1 >= -2147483648 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
5 rows returned
select * from test_source_1 where col1 >= -25 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
4 rows returned
select * from test_source_1 where col1 >= 33 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 5                    | 2147483647  |
+------------------------------------+
1 rows returned

select * from test_source_1 where col1 < -2147483648 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
0 rows returned
select * from test_source_1 where col1 < -25 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 < 33 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
| 3                    | 0           |
+------------------------------------+
3 rows returned
select * from test_source_1 where col1 < 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
+------------------------------------+
4 rows returned

select * from test_source_1 where col1 <= -2147483648 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
+------------------------------------+
1 rows returned
select * from test_source_1 where col1 <= -25 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
+------------------------------------+
2 rows returned
select * from test_source_1 where col1 <= 33 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
+------------------------------------+
4 rows returned
select * from test_source_1 where col1 <= 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 1                    | -2147483648 |
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
5 rows returned

select * from test_source_1 where col1 > -25 and col1 < 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 3                    | 0           |
| 4                    | 33          |
+------------------------------------+
2 rows returned
select * from test_source_1 where col1 > -25 and col1 <= 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -25 and col1 < 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
+------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -25 and col1 <= 2147483647 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
| 2                    | -25         |
| 3                    | 0           |
| 4                    | 33          |
| 5                    | 2147483647  |
+------------------------------------+
4 rows returned

select * from test_source_1 where col1 > 33 and col1 < -25 order by col0;
+------------------------------------+
| col0                 | col1        |
+------------------------------------+
0 rows returned

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- BIGINT;

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 bigint,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_3;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
5 rows returned
select * from test_source_1 where col1 = -9223372036854775808;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = -25;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 2                    | -25                  |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 3                    | 0                    |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 33;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 4                    | 33                   |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 9223372036854775807;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 5                    | 9223372036854775807  |
+---------------------------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = 99;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
0 rows returned

select * from test_source_1 where col1 > -9223372036854775808 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
4 rows returned
select * from test_source_1 where col1 > -25 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
3 rows returned
select * from test_source_1 where col1 > 33 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 5                    | 9223372036854775807  |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 > 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
0 rows returned

select * from test_source_1 where col1 >= -9223372036854775808 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
5 rows returned
select * from test_source_1 where col1 >= -25 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
4 rows returned
select * from test_source_1 where col1 >= 33 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 5                    | 9223372036854775807  |
+---------------------------------------------+
1 rows returned

select * from test_source_1 where col1 < -9223372036854775808 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
0 rows returned
select * from test_source_1 where col1 < -25 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 < 33 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
| 3                    | 0                    |
+---------------------------------------------+
3 rows returned
select * from test_source_1 where col1 < 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
+---------------------------------------------+
4 rows returned

select * from test_source_1 where col1 <= -9223372036854775808 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
+---------------------------------------------+
1 rows returned
select * from test_source_1 where col1 <= -25 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
+---------------------------------------------+
2 rows returned
select * from test_source_1 where col1 <= 33 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
+---------------------------------------------+
4 rows returned
select * from test_source_1 where col1 <= 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 1                    | -9223372036854775808 |
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
5 rows returned

select * from test_source_1 where col1 > -25 and col1 < 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 3                    | 0                    |
| 4                    | 33                   |
+---------------------------------------------+
2 rows returned
select * from test_source_1 where col1 > -25 and col1 <= 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -25 and col1 < 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
+---------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -25 and col1 <= 9223372036854775807 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
| 2                    | -25                  |
| 3                    | 0                    |
| 4                    | 33                   |
| 5                    | 9223372036854775807  |
+---------------------------------------------+
4 rows returned

select * from test_source_1 where col1 > 33 and col1 < -25 order by col0;
+---------------------------------------------+
| col0                 | col1                 |
+---------------------------------------------+
0 rows returned

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- DOUBLE;

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 double,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_4;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 = -1234.4321;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = -0.002;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -0.002000                                                                                     |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.000000                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 0.0034;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 4                    | 0.003400                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 4321.5436;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = 42345.67;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

select * from test_source_1 where col1 > -1234.4321 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 > -0.002 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 > 0.0034 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 > 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

select * from test_source_1 where col1 >= -1234.4321 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 >= -0.002 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 >= 0.0034 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned

select * from test_source_1 where col1 < -1234.4321 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned
select * from test_source_1 where col1 < -0.002 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 < 0.0034 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 < 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned

select * from test_source_1 where col1 <= -1234.4321 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 <= -0.002 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 <= 0.0034 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 <= 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -1234.432100                                                                                  |
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned

select * from test_source_1 where col1 > -0.002 and col1 < 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 > -0.002 and col1 <= 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -0.002 and col1 < 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -0.002 and col1 <= 4321.5436 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -0.002000                                                                                     |
| 3                    | 0.000000                                                                                      |
| 4                    | 0.003400                                                                                      |
| 5                    | 4321.543600                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned

select * from test_source_1 where col1 > 33.0 and col1 < -25.12 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- DECIMAL;

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 decimal(10,2),
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_5;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 = -99999999.99;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = -123.23;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -123.23                                                                                       |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.00                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 372.19;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 4                    | 372.19                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 99999999.99;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = 42345.67;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

select * from test_source_1 where col1 > -99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 > -123.23 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 > 372.19 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 > 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

select * from test_source_1 where col1 >= -99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 >= -123.23 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 >= 372.19 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned

select * from test_source_1 where col1 < -99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned
select * from test_source_1 where col1 < -123.23 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 < 372.19 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 < 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned

select * from test_source_1 where col1 <= -99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 <= -123.23 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 <= 372.19 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned
select * from test_source_1 where col1 <= 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | -99999999.99                                                                                  |
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned

select * from test_source_1 where col1 > -123.23 and col1 < 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 > -123.23 and col1 <= 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -123.23 and col1 < 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
+----------------------------------------------------------------------------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= -123.23 and col1 <= 99999999.99 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | -123.23                                                                                       |
| 3                    | 0.00                                                                                          |
| 4                    | 372.19                                                                                        |
| 5                    | 99999999.99                                                                                   |
+----------------------------------------------------------------------------------------------------------------------+
4 rows returned

select * from test_source_1 where col1 > 33.0 and col1 < -25.12 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- VARCHAR;

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 varchar,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_6;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | a                                                                                             |
| 2                    | abc                                                                                           |
| 3                    | abcd                                                                                          |
| 4                    | abcz                                                                                          |
| 5                    | z                                                                                             |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 order by col1;
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | a                                                                                             |
| 2                    | abc                                                                                           |
| 3                    | abcd                                                                                          |
| 4                    | abcz                                                                                          |
| 5                    | z                                                                                             |
+----------------------------------------------------------------------------------------------------------------------+
5 rows returned
select * from test_source_1 where col1 = 'a';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 1                    | a                                                                                             |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 'abc';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 2                    | abc                                                                                           |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 'abcd';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 3                    | abcd                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 'abcz';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 4                    | abcz                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
select * from test_source_1 where col1 = 'z';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
| 5                    | z                                                                                             |
+----------------------------------------------------------------------------------------------------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = 'foo';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned
select * from test_source_1 where col1 = '';
+----------------------------------------------------------------------------------------------------------------------+
| col0                 | col1                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
0 rows returned

-- Binary key encoding of VARCHAR is currenty not memcomparable, see https://github.com/cashapp/pranadb/issues/419;
-- uncomment these tests when this is fixed;

--select * from test_source_1 where col1 > 'a' order by col0;
--select * from test_source_1 where col1 > 'abc' order by col0;
--select * from test_source_1 where col1 > 'abcz' order by col0;
--select * from test_source_1 where col1 > 'z' order by col0;

--select * from test_source_1 where col1 >= 'a' order by col0;
--select * from test_source_1 where col1 >= 'abc' order by col0;
--select * from test_source_1 where col1 >= 'abcz' order by col0;
--select * from test_source_1 where col1 >= 'z' order by col0;

--select * from test_source_1 where col1 < 'a' order by col0;
--select * from test_source_1 where col1 < 'abc' order by col0;
--select * from test_source_1 where col1 < 'abcz' order by col0;
--select * from test_source_1 where col1 < 'z' order by col0;

--select * from test_source_1 where col1 <= 'a' order by col0;
--select * from test_source_1 where col1 <= 'abc' order by col0;
--select * from test_source_1 where col1 <= 'abcz' order by col0;
--select * from test_source_1 where col1 <= 'z' order by col0;

--select * from test_source_1 where col1 > 'abc' and col1 < 'z' order by col0;
--select * from test_source_1 where col1 > 'abc' and col1 <= 'z' order by col0;
--select * from test_source_1 where col1 >= 'abc' and col1 < 'z' order by col0;
--select * from test_source_1 where col1 >= 'abc' and col1 <= 'z' order by col0;

--select * from test_source_1 where col1 > 'z' and col1 < 'a' order by col0;

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- TIMESTAMP(6);

--create topic testtopic1;
create source test_source_1(
    col0 bigint,
    col1 timestamp(6),
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic1",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_10;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 2                    | 2021-02-13 21:11:07.645465 |
| 3                    | 2001-11-27 21:34:25.575656 |
| 4                    | 1991-06-11 14:34:12.575656 |
+---------------------------------------------------+
4 rows returned
-- should return row;
select * from test_source_1 where col1 = '2001-11-27 21:34:25.575656';
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 3                    | 2001-11-27 21:34:25.575656 |
+---------------------------------------------------+
1 rows returned
-- should not return row;
select * from test_source_1 where col1 = '2001-11-27 21:34:25';
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
0 rows returned

select * from test_source_1 where col1 > '2001-11-27' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 2                    | 2021-02-13 21:11:07.645465 |
| 3                    | 2001-11-27 21:34:25.575656 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 > '2001-11-27 21:34:25.575656' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 2                    | 2021-02-13 21:11:07.645465 |
+---------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= '2001-11-27 21:34:25.575656' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 2                    | 2021-02-13 21:11:07.645465 |
| 3                    | 2001-11-27 21:34:25.575656 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 < '2020-01-01 01:00:00.123456' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 3                    | 2001-11-27 21:34:25.575656 |
| 4                    | 1991-06-11 14:34:12.575656 |
+---------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 <= '2020-01-01 01:00:00.123456' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 3                    | 2001-11-27 21:34:25.575656 |
| 4                    | 1991-06-11 14:34:12.575656 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 > '1991-06-11 14:34:12.575656' and col1 < '2021-02-13 21:11:07.645465' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 3                    | 2001-11-27 21:34:25.575656 |
+---------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= '1991-06-11 14:34:12.575656' and col1 < '2021-02-13 21:11:07.645465' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 3                    | 2001-11-27 21:34:25.575656 |
| 4                    | 1991-06-11 14:34:12.575656 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= '1991-06-11 14:34:12.575656' and col1 <= '2021-02-13 21:11:07.645465' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.123456 |
| 2                    | 2021-02-13 21:11:07.645465 |
| 3                    | 2001-11-27 21:34:25.575656 |
| 4                    | 1991-06-11 14:34:12.575656 |
+---------------------------------------------------+
4 rows returned

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic1;

-- TIMESTAMP;

--create topic testtopic2;
create source test_source_1(
    col0 bigint,
    col1 timestamp,
    primary key (col0)
) with (
    brokername = "testbroker",
    topicname = "testtopic2",
    headerencoding = "json",
    keyencoding = "json",
    valueencoding = "json",
    columnselectors = (
        meta("key").k0,
        v1
    )
);
0 rows returned

--load data dataset_10;

create index index1 on test_source_1(col1);
0 rows returned

select * from test_source_1 order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 2                    | 2021-02-13 21:11:08.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
| 4                    | 1991-06-11 14:34:13.000000 |
+---------------------------------------------------+
4 rows returned
-- should return row;
select * from test_source_1 where col1 = '2001-11-27 21:34:26';
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 3                    | 2001-11-27 21:34:26.000000 |
+---------------------------------------------------+
1 rows returned

select * from test_source_1 where col1 > '2001-11-27' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 2                    | 2021-02-13 21:11:08.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
+---------------------------------------------------+
3 rows returned

select * from test_source_1 where col1 > '2001-11-27 21:34:26' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 2                    | 2021-02-13 21:11:08.000000 |
+---------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= '2001-11-27 21:34:26' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 2                    | 2021-02-13 21:11:08.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 < '2020-01-01 01:00:00' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 3                    | 2001-11-27 21:34:26.000000 |
| 4                    | 1991-06-11 14:34:13.000000 |
+---------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 <= '2020-01-01 01:00:00' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
| 4                    | 1991-06-11 14:34:13.000000 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 > '1991-06-11 14:34:13' and col1 < '2021-02-13 21:11:08' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
+---------------------------------------------------+
2 rows returned
select * from test_source_1 where col1 >= '1991-06-11 14:34:13' and col1 < '2021-02-13 21:11:08' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
| 4                    | 1991-06-11 14:34:13.000000 |
+---------------------------------------------------+
3 rows returned
select * from test_source_1 where col1 >= '1991-06-11 14:34:13' and col1 <= '2021-02-13 21:11:08' order by col0;
+---------------------------------------------------+
| col0                 | col1                       |
+---------------------------------------------------+
| 1                    | 2020-01-01 01:00:00.000000 |
| 2                    | 2021-02-13 21:11:08.000000 |
| 3                    | 2001-11-27 21:34:26.000000 |
| 4                    | 1991-06-11 14:34:13.000000 |
+---------------------------------------------------+
4 rows returned

drop index index1 on test_source_1;
0 rows returned
drop source test_source_1;
0 rows returned

--delete topic testtopic2;
